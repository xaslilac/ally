/* Ally 1.3. Copyright 2011, McKayla Washburn. MIT license. */ var $,Ally;$=Ally=(function(){var g=this||{},w=g,d=w.document,a=function(){return q.apply(m,arguments)},v=1.3,ms=1,mj=3,mn=0,bd=630.1,tag="final",dt={},m=a.prototype||{},$=function(u){if(u!==undefined)return true;},ep=/(Type|forEach|extend|merge|fuse|constructor|stringify|parse|valueOf|__proto__)/,ci=/(^\.|^\#)/,nc=/[^\w\d\-]/,np=/[\W\D]/;a.local=function(k,v){if(v){var jv=JSON.stringify(v);localStorage[k]=jv;return v;}else var pv=JSON.parse(localStorage[k]);return pv;};(function(n){var ua=n.userAgent,i,i2,i3,v;i=ua.indexOf('Chrome/');if(i>-1){i2=ua.indexOf('Safari/');v=ua.slice(i+7,i2-1);a.Chrome=n.Chrome=v;}i=ua.indexOf('Firefox/');if(i>-1){v=ua.substring(i+8);a.Firefox=n.Firefox=v;}i=ua.indexOf('Safari/');if(i>-1&&ua.indexOf('Chrome/')===-1){i2=ua.indexOf('Version/');v=ua.slice(i2+8,i-1);a.Safari=n.Safari=v;}if(/Opera\//.test(ua)){i=ua.indexOf('Version/');v=ua.substring(i+8);a.Opera=n.Opera=v;}i=ua.indexOf('MSIE');if(i>-1){i2=ua.substring(i).indexOf(';');v=ua.slice(i+5,i+i2);a.IE=n.IE=v;}i=ua.indexOf('AppleWebKit/');if(i>-1){i2=ua.substring(i).indexOf(' ');v=ua.slice(i+12,i+i2);a.WebKit=n.WebKit=v;}if(/Gecko\//.test(ua)){i=ua.indexOf('rv');i2=ua.substring(i).indexOf(')');v=ua.slice(i+3,i+i2);a.Gecko=n.Gecko=v;}i=ua.indexOf('Presto/');if(i>-1){i2=ua.substring(i).indexOf(' ');v=ua.slice(i+7,i+i2);a.Presto=n.Presto=v;}i=ua.indexOf('Trident/');if(i>-1){i2=ua.substring(i).indexOf(')');v=ua.slice(i+8,i+i2);a.Trident=n.Trident=v;}i=ua.indexOf('like Mac OS X');if(i>-1){i2=ua.indexOf('OS');v=ua.slice(i2+3,i-1);a.iOS=n.iOS=v;if(ua.indexOf('iPhone')>-1)a.iPhone=n.iPhone=true;if(ua.indexOf('iPod')>-1)a.iPod=n.iPod=true;if(ua.indexOf('iPad')>-1)a.iPad=n.iPad=true;}i=ua.indexOf('Android');if(i>-1){i2=ua.substring(i).indexOf(';');v=ua.slice(i+8,i+i2);a.Android=n.Android=v;}i=ua.indexOf('Intel Mac OS X');if(i>-1){i2=ua.substring(i).indexOf(';');v=ua.slice(i+15,i+i2);a.Mac=n.Mac=v;}i=ua.indexOf('Windows NT');if(i>-1){i2=ua.substring(i).indexOf(';');v=ua.slice(i+11,i+i2);a.Windows=n.Windows=v;}})(w.navigator);Object.prototype.Type="Object";HTMLElement.prototype.Type="HTMLElement";Number.prototype.Type="Number";Function.prototype.Type="Function";RegExp.prototype.Type="RegExp";Array.prototype.Type="Array";String.prototype.Type="String";Boolean.prototype.Type="Boolean";Object.prototype.extend=function(o,s){var p;if(s!==false||s!==true)s=true;if(s)var re=this;else{var re={};for(p in this)if(!ep.test(p))re[p]=this[p];}for(p in o){if(!ep.test(p))re[p]=o[p];}return re;};Object.prototype.merge=function(os){var p;var re={}.extend(this);os.forEach(function(o){if(o&&o.Type==="Object")for(p in o)if(!ep.test(p))re[p]=o[p];});return re;};Object.prototype.stringify=function(){return JSON.stringify(this);};Array.prototype.forEach=function(l,p){p=p||this;var re=[];for(var i=0;i<this.length;i++)if(i in this)re[i]=l.apply(p,[this[i],i,this]);return re;};Array.prototype.fuse=function(as){var re=[].extend(this);as.forEach(function(a){if(a.Type==="Array")a.forEach(function(v){re.push(v);});});return re;};String.prototype.insert=function(p,t){var s=this;if(p>s.length)p=s.length;var pr=s.slice(0,p);var af=s.substring(p);var n=pr+t+af;return n;};String.prototype.remove=function(s,e){var wo="",b,a;if(s.Type==="Number"){if(s<0)s=0;if(e>this.length)e=this.length;}if(s.Type==="String"){var st=s;s=this.indexOf(st);e=s+st.length;}b=this.slice(0,s);a=this.substring(e);wo=b+a;return wo;};String.prototype.flip=function(){var s=this,b="";for(var i=0;i<=s.length;i++){var r=s.length-i;b+=s.charAt(r);}return b;};String.prototype.parse=function(){return JSON.parse(this);};Number.prototype.absolute=function(){var n=this;if(n>=0)return n;else return n*-1;};Number.prototype.opposite=function(){var n=this;return n*-1;};a.byId=d.byId=function(){return d.getElementById.apply(d,arguments)};a.byClass=d.byClass=function(){return d.getElementsByClassName.apply(d,arguments)};a.byTag=d.byTag=function(){return d.getElementsByTagName.apply(d,arguments)};a.byQuery=d.byQuery=function(){return d.querySelectorAll.apply(d,arguments)};d.head=d.byTag('head')[0];a.extend({m:m,version:v,milestone:ms,major:mj,minor:mn,tag:tag,build:bd,data:dt,global:g,is:$});a.extend({ready:function(l){if(l&&l.Type==="Function"){a(w).event('load',function(){l.apply(a,[w]);});}}});var q=function(s,ma){var re=[];if(s){if(s.Type==="String"){s=s.toLowerCase();if(s==='body')re=[d.body].extend(m);else if(s==='head')re=[d.head].extend(m);else{var e=w.Sizzle?Sizzle(s,d,[]):d.byQuery(s);for(var i=0;i<e.length;i++)re.push(e[i]);re.extend(m);}}else if(s.Type==="Function"){if(d.readyState!=="complete")a.ready(s);else return s.apply(a,[w]);}else re=[s].extend(m);}re.selector=s;re.selected=[].extend(re);if(ma&&ma.Type==="Function")return ma.apply(re,[w,s]);else return re;};m.extend({add:function(t,s,b,c){if(!t){var pt=this[0].tagName.toLowerCase();if(pt==='body')t='div';if(pt==='div')t='p';else t='span';}var re=this.forEach(function(p,i){var e=d.createElement(t);p.appendChild(e);if(s){if(s[0]==="#"){if(i===0)e.id=s.replace('#','');else e.id=s.replace('#','')+"-"+i;}if(s[0]==="."){e.className=s.replace('.','');}}if(b)a(e).base(b);return e;});if(c)c.apply(re,[w]);return re;},remove:function(c){var re=this.forEach(function(e){e.parentNode.removeChild(e);return e;});if(c)c.apply(re,[w]);return re;}});m.extend({html:function(h,c){if(h)h=h.trim();if(h){var re=this.forEach(function(e){return e.innerHTML=h;});}else{var re=this.forEach(function(e){return e.innerHTML.trim();});}if(c)c.apply(re,[w]);return re;},value:function(v,c){if(v)v=v.trim();if(v){var re=this.forEach(function(e){return e.value=v;});}else{var re=this.forEach(function(e){return e.value.trim();});}if(c)c.apply(re,[w]);return re;},empty:function(c){var re=this.forEach(function(e){if(e.innerHTML)e.innerHTML="";if(e.value)e.value="";return"";});if(c)c.apply(re,[w]);return re;}});m.extend({attr:function(at,v,c){if(v){if(this[0].setAttribute){this.forEach(function(e){e.setAttribute(at,v);});}else{this.forEach(function(e){e[at]=v;});}}var re=this.forEach(function(e){return e[at];});if(c)c.apply(re,[w]);return re;},base:function(o,c){var p,np;for(p in o)if(!ep.test(p)){np=p;if(p.indexOf('_')>-1){while(np.indexOf('_')>-1)np=np.replace('_','-');}this.attr(np,o[p]);}return this;},removeAttr:function(at,c){if(this[0].removeAttribute){var re=this.forEach(function(e){e.removeAttribute(at);return e.getAttribute(at);});}else{var re=this.forEach(function(e){delete e[at];return e[at];});}if(c)c.apply(re,[w]);return re;}});m.extend({classes:function(){var re=this.forEach(function(e){return e.className;});return re;},addClass:function(ad,c){if(ad.Type==="String"){this.forEach(function(e){e.className+=" "+ad;});}else if(ad.Type==="Array"){this.forEach(function(e){ad.forEach(function(v){if(v&&v.Type==="String")e.className+=" "+v;});});}var re=this.classes();if(c)c.apply(re,[w]);return re;},removeClass:function(r,c){if(r.Type==="String"){this.forEach(function(e){e.className=e.className.remove(r,'');});}else if(r.Type==="Array"){this.forEach(function(e){r.forEach(function(v){if(v&&v.Type==="String")e.className=e.className.remove(value);});});}var re=this.classes();if(c)c.apply(re,[w]);return re;}});m.extend({css:function(p,v,pr,c){if(!pr)pr="";if(v){this.forEach(function(e){e.style.setProperty(p,v,pr);});}var re=this.forEach(function(e){if(e.style.getPropertyValue(p)){return e.style.getPropertyValue(p);}else{return getComputedStyle(e).getPropertyValue(p);}});if(c)c.apply(re,[w]);return re;},removeProperty:function(p,c){this.forEach(function(e){e.style.removeProperty(p);});var re=this.css(p);if(c)c.apply(re,[w]);return re;},transform:function(p,v,du){if(!$(du)||du&&du.Type!=="Number")du=300;this.css('transition','All '+du+'ms ease');this.css('-webkit-transition','All '+du+'ms ease');this.css('-moz-transition','All '+du+'ms ease');this.css('-o-transition','All '+du+'ms ease');this.css('transform',p+'('+v+')');this.css('-webkit-transform',p+'('+v+')');this.css('-moz-transform',p+'('+v+')');this.css('-o-transform',p+'('+v+')');},hide:function(du,c){if(!$(du)||du&&du.Type!=="Number")du=300;var re=[];this.css('display','block');this.css('opacity','1');var de=du/10,es=this,an=setInterval(function(){var cu=parseFloat(es.css('opacity')[0]);if(cu>=0.15)es.css('opacity',cu-0.1);else{es.css('opacity','0');es.css('display','none');clearInterval(an);if(c)c.apply(re,[w]);}},de);},show:function(du,c){if(!$(du)||du&&du.Type!=="Number")du=300;var re=[];this.css('display','block');this.css('opacity','0');var de=du/10,es=this,an=setInterval(function(){var cu=parseFloat(es.css('opacity')[0]);if(cu<=0.85)es.css('opacity',cu+0.1);else{es.css('opacity','1');clearInterval(ann);if(c)c.apply(re,[w]);}},de);}});m.extend({event:function(ev,l,c,ca){if(c!==true&&c!==false)c=false;this.forEach(function(e){e.addEventListener(ev,l,c);});if(ca)ca.apply(l,[w]);return[ev,l,c];},removeEvent:function(ev,c){this.forEach(function(e){e.removeEventListener.apply(e,ev);});if(c)c.apply(w,[w]);}});a.extend({average:function(ns){var av=0;ns.forEach(function(v){if(v&&v.Type==="Number")av+=v;});av/=ns.length;return av;},random:function(n,x,ro){if(!n)n=0;if(!x||x<n)max=min+10;var r=Math.random(),ra=x-n;r*=ra;if(ro)r=Math.round(r);return r+n;}});m.extend({open:function(u,me,as,c){if(!me)me="GET";if(as!==true&&as!==false)as=true;var es=this,xhr=new XMLHttpRequest();xhr.open(me,u,as);a(xhr).event('load',function(){es.html(xhr.responseText);});if(c)a(xhr).event('load',function(){c.apply(xhr,[w]);});xhr.send();return xhr;}});a.extend({xhr:function(u,me,as,h,c){me=me.toUpperCase();if(!me)method="GET";if(as!==true&&as!==false)as=true;if(!h)h={};if(u.Type==="String"){var xhr=new XMLHttpRequest();xhr.open(me,u,as);var p;if(h)for(p in h)if(h[p].Type==="String"&&!ep.test(p))xhr.setRequestHeader(p,h[p]);if(c)a(xhr).event('load',function(){c.apply(xhr,[w]);});xhr.send();return xhr;}else if(u.Type==="Array"){var re=u.forEach(function(s,i,l){if(s.Type==="String"){var xhr=new XMLHttpRequest();xhr.open(me,s,as);if(i===l.length-1&&c)a(xhr).event('load',function(){c.apply(xhr,[w]);});xhr.send();return xhr;}});return re;}},script:function(u,c,ca){if(!c&&c!==false)c=true;if(u.Type==="String"){var s=d.createElement('script');if(c)s.src=url;else s.src=u+"?"+a.random(0,10000,true);if(ca)a(s).event('load',ca);d.head.appendChild(s);return s;}else if(u.Type==="Array"){var re=url.forEach(function(sr,i,l){if(sr.Type==="String"){var s=d.createElement('script');if(c)s.src=sr;else s.src=sr+"?"+a.random(0,10000,true);if(i===l.length-1&&ca)a(script).event('load',ca);d.head.appendChild(s);return s;}});return re;}},styleSheet:function(u,me){if(!me)me="all";if(u.Type==="String"){var s=d.createElement('style');s.innerHTML="@import url("+u+") "+me+";";d.head.appendChild(s);return s;}if(u.Type==="Array"){var re=u.forEach(function(sr){var s=d.createElement('style');s.innerHTML="@import url("+sr+") "+me+";";d.head.appendChild(s);return s;});}}});a.keys={};a(function(){a('body').event('keydown',function(e){k=a.keys[e.keyCode],l=a.keys['all'];if(k){if(e.shiftKey){if(k.shift&&k.shift.down&&k.shift.down.Type==="Function")k.shift.down(e);}else if(k.down&&k.down.Type==="Function")k.down(e);}if(l){if(e.shiftKey){if(l.shift&&l.shift.down&&l.shift.down.Type==="Function")l.shift.down(e);}else if(l.down&&l.down.Type==="Function")l.down(e);}});a('body').event('keyup',function(e){k=a.keys[e.keyCode],l=a.keys['all'];if(k){if(e.shiftKey){if(k.shift&&k.shift.up&&k.shift.up.Type==="Function")k.shift.up(e);}else if(k.up&&k.up.Type==="Function")k.up(e);}if(l){if(e.shiftKey){if(l.shift&&l.shift.up&&l.shift.up.Type==="Function")l.shift.up(e);}else if(l.up&&l.up.Type==="Function")l.up(e);}});});a(w).event('deviceorientation',function(e){a.pitch=e.beta||0;a.roll=e.gamma||0;});a(w).event('MozOrientation',function(e){a.pitch=e.y*90||0;a.roll=e.x*90||0;});a.extend({pitch:0,roll:0});a.location={enable:function(){navigator.geolocation.watchPosition(function(l){a.longitude=l.coords.longitude||0;a.latitude=l.coords.latitude||0;});}};return a;}).apply(window);
